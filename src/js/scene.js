async function initialize(a){try{let t=a;await setGraphics(t),await addData(t),$("#schedule").removeClass("hideSchedule")}catch(a){console.error("Error:",a)}}function setGraphics(a){return new Promise((t,e)=>{let i=a,r=i.graphics.theme;$(".day>.backdrop>.sparkles").html(SVG_SCHEDULE_ACTIVE),$(`.theme.${r}`).removeClass("hidden"),setSVG(),setArtbox(i.graphics.theme),t()})}function addData(a){let t=a;const e=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];for(key in t)if(e.includes(key))setStream(key,t[key]);else if("graphics"==key){const a=t[key];$(".streamTitle").attr("placeholder",a.offlineString),$("#dateStart").text(`${a.dateStart}`),$("#dateEnd").text(`${a.dateEnd}`);let e=a.timezone,i=e.toUpperCase().replace("UTC",a.utc_gmt).replace("GMT",a.utc_gmt);if($("#timezone").html(i),"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="!=a.art){let t;console.log(a.artist),$("#artistCredits").text(`Art: ${a.artist}`),1==a.peek?(t=$("#peekArt"),$("#peekArt").removeClass("hidden")):(t=$("#containArt"),$("figure>*:not('#peekArt')").removeClass("hidden")),t.attr("src",a.art),t.css({"object-position":a.artObjPos,left:a.artLeft,top:a.artTop,transform:`scale(${a.artScale})`})}else $("#artistCredits").addClass("hidden")}return new Promise((a,t)=>{setTimeout(()=>{a()},100)})}function setSVG(){const a={monday:{dayCode:"svgDayM",dayFront:"#EB8F9A",dayBack:"#BF4A5F",textCol:"#D72137",decoFront:"#9D3541",decoBack:"#651A27"},tuesday:{dayCode:"svgDayT",dayFront:"#EBAB8F",dayBack:"#BF824A",textCol:"#D75921",decoFront:"#9D6635",decoBack:"#653B1A"},wednesday:{dayCode:"svgDayW",dayFront:"#EBDB8F",dayBack:"#BFB44A",textCol:"#D7B721",decoFront:"#9D8C35",decoBack:"#655E1A"},thursday:{dayCode:"svgDayT",dayFront:"#ACEB8F",dayBack:"#4ABF57",textCol:"#5BD721",decoFront:"#3C9D35",decoBack:"#1A651A"},friday:{dayCode:"svgDayF",dayFront:"#8FC8EB",dayBack:"#4A78BF",textCol:"#2193D7",decoFront:"#35539D",decoBack:"#1A3B65"},saturday:{dayCode:"svgDayS",dayFront:"#C38FEB",dayBack:"#9A4ABF",textCol:"#8921D7",decoFront:"#73359D",decoBack:"#4C1A65"},sunday:{dayCode:"svgDayS",dayFront:"#EB8FE2",dayBack:"#BF4AB6",textCol:"#D721C7",decoFront:"#9D3593",decoBack:"#651A5A"}};for(const t in a)$(`.day[data-day="${t}"] .overlay>.dayStar`).html(SVG_SPARKLE_DAY),$(`.day[data-day="${t}"] .overlay>.dayStar>.svgDay .svgDayBack>path`).css("fill",a[t].dayBack),$(`.day[data-day="${t}"] .overlay>.dayStar>.svgDay .svgDayFront>path`).css("fill",a[t].dayFront),$(`.day[data-day="${t}"] .overlay>.dayStar>.svgDay .${a[t].dayCode}`).attr("visibility","visible"),$(`.day[data-day="${t}"] .overlay>.dayStar>.svgDay .${a[t].dayCode}>path`).css("fill",a[t].textCol),$(`.day[data-day="${t}"] .overlay .timeBG`).html(SVG_TIME_PLANET),$(`.day[data-day="${t}"] .overlay .timeBG>.svgTimePlanet .svgTimePlanetBack>path`).css("fill",a[t].decoBack),$(`.day[data-day="${t}"] .overlay .timeBG>.svgTimePlanet .svgTimePlanetFront>path`).css("fill",a[t].decoFront),$(`.day[data-day="${t}"] .overlay .activeR`).html(SVG_SPARKLE_R),$(`.day[data-day="${t}"] .overlay .activeR>.svgSparkR .svgSparkRBack>path`).css("fill",a[t].decoBack),$(`.day[data-day="${t}"] .overlay .activeR>.svgSparkR .svgSparkRFront>path`).css("fill",a[t].decoFront),$(`.day[data-day="${t}"] .overlay .activeL`).html(SVG_SPARKLE_L),$(`.day[data-day="${t}"] .overlay .activeL>.svgSparkL .svgSparkLBack>path`).css("fill",a[t].decoBack),$(`.day[data-day="${t}"] .overlay .activeL>.svgSparkL .svgSparkLFront>path`).css("fill",a[t].decoFront)}function setStream(a,t){const e=75,i=110,r=1,o=.73;let n=$(`.streamTitle[data-day=${a}]`);if(""!=t.title&&""!=t.time){$(`.day[data-day=${a}] .backdropCol`).removeClass("noStream"),$(`.streamInfo[data-day=${a}]`).removeClass("hidden"),$(`.day[data-day=${a}] .sparkles`).removeClass("hidden"),n.val(t.title),$(`.streamTime[data-day=${a}]`).val(t.time);let d=getTextWidth(n.val(),getCanvasFont(n)),s=1006;if(d/s*100>e){let a=mapRange(e,i,r,o,d/s*100),t=mapRange(e,i,1.15,1,d/s*100);if(n.css("transform",`scaleX(${a}) scaleY(${t})`),a==o){let a=n.val().length;n.attr("maxlength",a)}else n.removeAttr("maxlength")}else n.css("transform","scaleX(1) scaleY(1.15)")}else $(`.day[data-day=${a}] .backdropCol`).addClass("noStream")}function getTextWidth(a,t){const e=getTextWidth.canvas||(getTextWidth.canvas=document.createElement("canvas")),i=e.getContext("2d");i.font=t;const r=i.measureText(a);return r.width}function getCssStyle(a,t){return a.css(t)}function getCanvasFont(a=document.body){const t=getCssStyle(a,"font-weight")||"normal",e=getCssStyle(a,"font-size")||"16px",i=getCssStyle(a,"font-family")||"Times New Roman";return`${t} ${e} ${i}`}function setArtbox(a){let t={regular:{imgMask:MEDIA_REGULAR_IMG_MASK,imgX:5,imgY:5,imgW:45,imgH:60,imgAlpha:1,imgBlend:"hard-light",imgBack:MEDIA_BLANK_IMAGE,imgBackX:0,imgBackY:0,imgBackW:0,imgBackH:0,imgFront:MEDIA_BLANK_IMAGE,imgFrontX:0,imgFrontY:0,imgFrontW:0,imgFrontH:0,filter:"unset"},pastel:{imgMask:MEDIA_PASTEL_IMG_MASK,imgX:-2,imgY:2,imgW:58,imgH:70,imgAlpha:.9,imgBlend:"normal",imgBack:MEDIA_PASTEL_IMG_BACK,imgBackX:-2,imgBackY:2,imgBackW:58,imgBackH:70,imgFront:MEDIA_BLANK_IMAGE,imgFrontX:0,imgFrontY:0,imgFrontW:0,imgFrontH:0,filter:"unset"},empty:{imgMask:MEDIA_EMPTY_IMG_MASK,imgX:0,imgY:2,imgW:57,imgH:70,imgAlpha:.7,imgBlend:"hard-light",imgBack:MEDIA_BLANK_IMAGE,imgBackX:0,imgBackY:0,imgBackW:0,imgBackH:0,imgFront:MEDIA_BLANK_IMAGE,imgFrontX:0,imgFrontY:0,imgFrontW:0,imgFrontH:0,filter:"brightness(1) grayscale(0.2) contrast(1) saturate(0.5)"},satellite:{imgMask:MEDIA_SATELLITE_IMG_MASK,imgX:0,imgY:5,imgW:57,imgH:72,imgAlpha:.9,imgBlend:"hard-light",imgBack:MEDIA_SATELLITE_IMG_BACK,imgBackX:-15,imgBackY:-7,imgBackW:92,imgBackH:92,imgFront:MEDIA_SATELLITE_IMG_FRONT,imgFrontX:-17,imgFrontY:-7,imgFrontW:90,imgFrontH:90,filter:"unset"},moon:{imgMask:MEDIA_MOON_IMG_MASK,imgX:0,imgY:5,imgW:55,imgH:65,imgAlpha:1,imgBlend:"normal",imgBack:MEDIA_BLANK_IMAGE,imgBackX:0,imgBackY:0,imgBackW:0,imgBackH:0,imgFront:MEDIA_MOON_IMG_FRONT,imgFrontX:-14,imgFrontY:-3.5,imgFrontW:83,imgFrontH:83,filter:"unset"}};$("#art").css({"mask-image":`url(${t[a].imgMask})`,right:`${t[a].imgX}%`,top:`${t[a].imgY}%`,width:`${t[a].imgW}%`,height:`${t[a].imgH}%`,opacity:`${t[a].imgAlpha}`,"mix-blend-mode":`${t[a].imgBlend}`}),$("#artFront").css({"background-image":`url(${t[a].imgFront})`,right:`${t[a].imgFrontX}%`,top:`${t[a].imgFrontY}%`,width:`${t[a].imgFrontW}%`,height:`${t[a].imgFrontH}%`}),$("#artBack").css({"background-image":`url(${t[a].imgBack})`,right:`${t[a].imgBackX}%`,top:`${t[a].imgBackY}%`,width:`${t[a].imgBackW}%`,height:`${t[a].imgBackH}%`}),$(":root").css("--schedule-filter",`${t[a].filter}`)}const qr=function(a,t){return Math.round(a*10**t)/10**t},to_ang=function(a){let t=a*(180/Math.PI);return t},to_rad=function(a){let t=a*Math.PI/180;return t},clamp=function(a,t,e){return Math.min(t,Math.max(a,e))},mapRange=function(a,t,e,i,r){let o,n=e+(r-a)/(t-a)*(i-e);return o=e<i?clamp(e,i,n):clamp(i,e,n),o},calculateDistance=function(a,t,e,i){const r=e-a,o=i-t;return Math.sqrt(r*r+o*o)},lengthdir_x=function(a,t){let e,i=a,r=to_rad(t);return e=Math.cos(r)*i,e},lengthdir_y=function(a,t){let e,i=a,r=to_rad(t);return e=Math.sin(r)*i,e};let data={};$(document).ready(function(){$.getJSON("./sceneData/schedule.json",function(a){data=a}).then(function(){initialize(data)})});